<?xml version="1.0" encoding="UTF-8"?>
<odoo>
<data>
<!-- %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Views Portion %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% -->

    <!--===================== [Sale Order Extension Form View-START] ====================-->

    <record id="so_form_view_extension" model="ir.ui.view"> 
        <field name="name">so_form_view_extension</field> 
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale.view_order_form"/>
        <field name="type">form</field> 
        <field name="arch" type="xml">


            <xpath expr="//field[@name='order_line']/tree" position="attributes">
                <attribute name="editable">top</attribute>
            </xpath>
            
            <xpath expr="//header" position="inside">
                <button name="get_order_lines" string="Get Order Lines" type="object" class="oe_highlight" invisible="1"/>
                <button name="create_invoice" string="Create Invoice" type="object" class="oe_highlight"/>
                <button name="create_edari_fee" string="Create Edari Fee" type="object" class="oe_highlight" invisible="1"/>
                <button name="approve_applicant" string="Approve Applicant" type="object" class="oe_highlight" attrs="{'invisible':[('applicant','=',False),('applicant_approve_check','=',False),]}"/>
            </xpath>
            <xpath expr="//field[@name='partner_id']" position="after">
                <field name="applicant" options="{'no_create_edit':True}" readonly="1"/>
                <field name="employee" options="{'no_create_edit':True}" readonly="1"/>
                <field name="contract" options="{'no_create_edit':True}"/>
                <field name="contract_state" />
                <field name="no_of_months"/>
                <field name="per_month_gross_salary"/>
                <field name="costcard_type"/>
                <field name="job_pos" options="{'no_create_edit': True}"/>
                <field name="template" options="{'no_create_edit': True}"/>
                <field name="version"/>
                <field name="invoice_id" readonly="1"/>
                <field name="applicant_approve_check" invisible="1"/>
                <field name="candidate_name" readonly="0"/>
                <field name="budget"/>
            </xpath>
            <xpath expr="//field[@name='payment_term_id']" position="after">
                <!-- <field name="interval"/> -->
                <field name="work_days_type"/>
                <field name="leave_type" attrs="{'invisible':[('work_days_type','!=','actual_working_days')]}"/>
                <field name="contract_start_date"/>
                <field name="contract_end_date"/>
                <field name="estimated_start_date"/>
                <field name="date_invoice"/>
                <field name="invoice_amount"/>
                <field name="percentage"/>
                <field name="month_days_deduction"/>
                <field name="monthly_deduction"/>
            </xpath>

            <xpath expr="/form/sheet/notebook/page/field[@name='order_line']/tree/field[@name='name']" position="after">
                <field name="code" attrs="{'readonly':[('costcard_type','=','fixed')]}"/>
                <field name="payment_type" attrs="{'readonly':[('costcard_type','=','fixed')]}"/>
                <field name="based_on_wd" invisible="1"/>
                <field name="costcard_type" invisible="0"/>
                <field name="manual_amount" attrs="{'readonly':[('costcard_type','!=','manual')]}"/>
                <field name="categ_id" invisible="0"/>
                <field name="recomputable" invisible="0"/>
            </xpath>
             <xpath expr="/form/sheet/notebook/page/field[@name='order_line']/tree/field[@name='name']" position="after">
                <field name="code" attrs="{'readonly':[('costcard_type','=','fixed')]}"/>
            </xpath>

            <!-- Making tree fields readonly -->
            <xpath expr="/form/sheet/notebook/page/field[@name='order_line']/tree/field[@name='name']" position="attributes">
                <attribute name="attrs">{'readonly': [('costcard_type','=', 'fixed')]}</attribute>
            </xpath>
            <xpath expr="/form/sheet/notebook/page/field[@name='order_line']/tree/field[@name='product_uom_qty']" position="attributes">
                <attribute name="attrs">{'readonly': [('costcard_type','=', 'fixed')]}</attribute>
            </xpath>
            <xpath expr="/form/sheet/notebook/page/field[@name='order_line']/tree/field[@name='price_unit']" position="attributes">
                <attribute name="attrs">{'readonly': [('costcard_type','=', 'fixed')]}</attribute>
            </xpath>
            <xpath expr="/form/sheet/notebook/page/field[@name='order_line']/tree/field[@name='tax_id']" position="attributes">
                <attribute name="attrs">{'readonly': [('costcard_type','=', 'fixed')]}</attribute>
            </xpath>
            <xpath expr="/form/sheet/notebook/page/field[@name='order_line']/tree/field[@name='product_id']" position="attributes">
                <attribute name="attrs">{'readonly': [('costcard_type','=', 'fixed')]}</attribute>
            </xpath>

            <xpath expr="/form/sheet/notebook/page/field[@name='order_line']/tree/field[@name='price_unit']" position="replace">
                <field name="price_unit" attrs="{'readonly': [('qty_invoiced', '&gt;', 0), ('costcard_type','=', 'fixed')]}" sum="Total"/>
            </xpath>

        </field> 
    </record>

    <!--********************* [Sale Order Extension Form View-ENDS] *********************-->


    <!-- inheriting External Tree view of SO quotation -->
    <record id="QutationTreeViewExtension" model="ir.ui.view"> 
        <field name="name">QutationTreeViewExtension</field> 
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale.view_quotation_tree_with_onboarding"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name ='partner_id']" position="after">
                <field name="candidate_name"/>
            </xpath>
        </field> 
    </record>
    <!-- inheriting External Tree view of SOs -->
    <record id="SOTreeViewExtension" model="ir.ui.view"> 
        <field name="name">SOTreeViewExtension</field> 
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale.view_order_tree"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name ='partner_id']" position="after">
                <field name="candidate_name"/>
            </xpath>
        </field> 
    </record>

    <!-- Changing name of SO action -->
    <record id="sale.action_orders" model="ir.actions.act_window">
        <field name="name">Cost Cards</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">sale.order</field>
        <field name="view_mode">tree,kanban,form,calendar,pivot,graph,activity</field>
        <field name="search_view_id" ref="sale.sale_order_view_search_inherit_sale"/>
        <field name="context">{}</field>
        <field name="domain">[('state', 'not in', ('draft', 'sent', 'cancel'))]</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Create a new quotation, the first step of a new sale!
            </p><p>
                Once the quotation is confirmed, it becomes a sales order.<br/> You will be able to create an invoice and collect the payment.
            </p>
        </field>
    </record>


    <menuitem id="sale.menu_sale_order" name="Cost Cards" action="sale.action_orders" parent="sale.sale_order_menu" sequence="2" groups="sales_team.group_sale_salesman"/>


    <record id="sale.action_quotations_with_onboarding" model="ir.actions.act_window">
        <field name="name">Cost Cards Quotations</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">sale.order</field>
        <field name="view_id" ref="sale.view_quotation_tree_with_onboarding"/>
        <field name="view_mode">tree,kanban,form,calendar,pivot,graph,activity</field>
        <field name="search_view_id" ref="sale.sale_order_view_search_inherit_quotation"/>
        <field name="context">{'search_default_my_quotation': 1}</field>
        <field name="help" type="html">
          <p class="o_view_nocontent_smiling_face">
            Create a new quotation, the first step of a new sale!
          </p><p>
            Once the quotation is confirmed by the customer, it becomes a sales order.<br/> You will be able to create an invoice and collect the payment.
          </p>
        </field>
    </record>

    <menuitem id="sale.menu_sale_quotations"
        action="sale.action_quotations_with_onboarding"
        parent="sale.sale_order_menu"
        name="Cost Cards Quotations"
        sequence="1" groups="sales_team.group_sale_salesman"/>

    
</data>
</odoo>


                <!-- <xpath expr="//field[@name='origin']" position="attributes">
                    <attribute name="attrs">{'invisible': [('customer','=', True)]}</attribute>
                </xpath> -->